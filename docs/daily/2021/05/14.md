# 2021年05月14日

::: tip 天气
今日杭州晴，天气炎热。
:::

## 网页性能优化

### 缓存

- 客户端控制的强缓存策略

### 降低请求成本

- `HTTP DNS`：由客户端控制，隔一段时间主动请求 `DNS` 获取域名 `IP` ，不走系统的 `DNS`
- `TCP / TLS` 连接的复用：由服务端升级到 `HTTP2`，尽量合并域名

### 减少请求数

- `JavaScript`、`CSS` 打包到 `HTML`
- 用 `JavaScript` 控制图片的异步加载和懒加载
- 小型图片使用 `data-uri`

### 减少传输体积

- 尽量使用 `SVG \ gradient` 等代替图片
- 根据机型和网络状况控制图片清晰度
- 对低清晰度图片使用锐化来提升体验
- 设计上避免大型背景图

### 减少页面体积，提升网络加载

- 静态资源的压缩合并（`JS` 代码压缩合并、`CSS` 代码压缩合并、雪碧图）
- 静态资源缓存（资源名称加 `MD5` 戳）
- 使用 `CDN` 让资源加载更快

### 优化页面渲染

- `CSS` 放前面，`JS` 放后面
- 懒加载（图片懒加载、下拉加载更多）
- 减少 `DOM` 查询，对 `DOM` 查询做缓存
- 减少 `DOM` 操作，多个操作尽量合并在一起执行（`DocumentFragment`）
- 事件节流
- 尽早执行操作（`DOMContentLoaded`）
- 使用 `SSR` 后端渲染，数据直接输出到 `HTML` 中，减少浏览器使用 `JS` 模板渲染页面 `HTML` 的时间
